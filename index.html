<!DOCTYPE html>
<meta charset=utf-8>
<meta name=viewport content="width=device-width">
<style>
canvas{x-image-rendering:-moz-crisp-edges;image-rendering:pixelated;width:100%;height:auto}
html,body{height:100%;overflow:hidden}
</style>
<canvas id=c width=320 height=180></canvas>

<script>let e,l=e=>e,x=(e,l)=>Array.from({length:e},l),t=Math,{floor:o,ceil:a,sin:n,cos:i,abs:r,round:_,min:f,max:b}=t,{height:g,width:d}=c,h=g/2,s=d/2,m=c.getContext("2d"),p=2*t.PI,y=.7854,T="xx             x xx\nxx               xx\nxx            x  xx\nxx               xx\nxx               xx\nxx               xx\nxx               xx\nxx               xx\nxx               xx\nxx               xx\nxxx              xx\n".repeat(10).trim().split("\n").map((e=>e.split("").map((e=>"x"===e)))),u=T[0].length,S=T.length,w=(e,l)=>T[l][e],M=e=>new Promise(e),P=e=>M((l=>setTimeout(l,e))),A=(e,l,x)=>e+(l-e)*x,v=(e,l,x)=>(x-e)/(l-e),C=(e,l,x)=>x<e?e:x>l?l:x,R=(e,l,x)=>x<e?l+(x-e):x>l?e+(x-l):x,$=(e,l,x,t,o=1/32)=>{for(let a=0;a<=1;a+=o){if(w(0|A(e,x,a),0|A(l,t,a)))return 1}},k=M((l=>{e=l})),q=P(),G={},D=e=>l=>G[l.key]=e;onkeydown=D(1),onkeyup=D(),onclick=e;let O=e=>!!G[e],F=()=>(W(),z(),xe(),setTimeout(F,42));q.then(F);let I,j,z=()=>{let e,l=-10,t=-10,_=h- -g*H/40;for(;(t+=4)<g;)e=r(t-_),e=v(0,_,e),e=A(.3,.6,e),e*=100,m.fillStyle=`hsl(88, ${e}%, ${e}%)`,m.fillRect(0,t,d,10);let c=e=>3.1*g/e,p=0,T=0,M=0,P=0,$=0,k=0,q=x((d+20)/2|0,(()=>{let e=A(-y,y,l/d),x=((e,l,x)=>{let t,r,_,f,b=.1,g=n(x)*b,d=i(x)*b,h=1e4;for(;h--&&(b+=.1,!(b>40))&&(l+=d,e=R(0,u-1,e+=g),l=R(0,S-1,l),t=o(e),r=o(l),_=a(e),f=a(l),!(_>=u||f>=S||t<0||r<0));)if(w(t,r)||w(_,f))return[e,l,b];return[]})(B,E,e)[2],t=c(x)||0;l+=2,(!x||x>40)&&(l<s&&!p&&(p=l+2),l>s&&(T=l+2));for(let e=.05;e<2;e+=.05)t>g*e&&(t*=1.03);let r=-g*H/x;return r=h-t/2-r|0,k=f(k,r),P=b(P,r+t),$||=r,M||=r+t,[l,x,r,t]})),G=c(40),D=p,O=_-G/2|0,F=m.createRadialGradient(s,O+100,500,s,O+100,40);F.addColorStop(0,"yellow"),F.addColorStop(1,"purple"),m.fillStyle=F,m.fillRect(0,0,d,g);let I=m.createRadialGradient(p||T,O+200,70,(p||T)-10,O+200,200);I.addColorStop(0,"blue"),I.addColorStop(1,"purple"),m.fillStyle=I,m.beginPath(),m.moveTo(D,O+G),m.lineTo(T||p,O+G),m.lineTo(d,(P+k)/2),m.lineTo(2*d,2*g),m.lineTo(-d,2*g),m.lineTo(0,(M+$)/2),m.fill(),p&&T&&(m.fillStyle="rgba(0,0,0,0.4)",m.fillRect(D,O,T-p,2+(0|G)));for(let[e,l,x,t]of q){let o=v(0,40,l);o=C(0,l,o);let a=A(255,0,o);m.fillStyle=`rgb(${a}, ${a}, ${a})`,m.fillRect(e,x,4,t)}},B=5,E=5,H=3,J=0,K=1.2,L=1,N=0,Q=.6,U=0,V=0,W=()=>{if(L){let e=K,l=0,x=0;O("w")&&(e+=1),O("s")&&(e-=1),O("a")&&(l-=1),O("d")&&(l+=1);let t,o=H-1;O(" ")&&V>5?(x=3,V=0):(H<.05?(H=r(H),x=r(U),U=r(U),V=0):r(o)>2?(x=.2*-o,V=0):(x=.1*-o,V++),x=A(U,x,.1)),l&&e&&(l*=(.707+1)/2,e*=(.707+1)/2),l=A(N,l,.04),e=A(Q,e,.2),N=l,Q=e,U=x,l=1.7*l+B,e=1.7*e+E,x+=H,l=R(0,u-1,l),e=R(0,S-1,e),l>0&&e>0&&l<u&&e<S&&(_(B)==_(u/2)||J||!(t=$(B,E,l+1,e)||$(B,E,l-1,e)||$(B,E,l,e)))&&(B=l,E=e,H=x),t&&(L--,J++,(async()=>{let e=Date.now()+500;for(;Date.now()<e;)B=A(B,u/2,.3),await P(42);L++,J--})())}},X=0,Y=0,Z=N,ee=Q,le=U,xe=()=>{X+=.1*r(r(Q)-r(N));let e=C(0,10,4*C(0,1,Q-K)+6*C(0,1,Q-ee))/10;Y+=e,Z=A(Z,N,.1),ee=A(ee,Q,.1),le=A(le,U,.1);let l=[s+1,g-30-15],x=[s-30,g-30+20],t=[s+30,g-30+20],o=[s-1,g-32];l[0]+=10*N,l[1]+=7*r(N),o[0]-=5*N,o[1]-=3*r(N),x[1]-=4*r(N),t[1]-=4*r(N),x[0]+=8*r(N),t[0]-=8*r(N),l[1]+=5*(Q-K),x[0]+=8*(ee-K),t[0]-=8*(ee-K);for(let e of[l,x,t,o]){let l=-2*r(Z)+9*(ee-K);e[1]+=l,e[1]-=A(0,4*n(X),v(0,4,r(l))),e[0]=1.2*_(e[0]*(5/6)),e[1]=1.2*_(e[1]*(5/6))}m.fillStyle="black",m.beginPath(),m.moveTo(...l),m.lineTo(...x),m.lineTo(...t),m.lineTo(...l),m.fill(),m.fillStyle="gray",m.beginPath(),m.moveTo(...l),m.lineTo(...o),m.lineTo(...t),m.lineTo(...l),m.fill(),m.fillStyle="green",m.beginPath(),m.moveTo(...l),m.lineTo(...o),m.lineTo(...x),m.lineTo(...l),m.fill(),m.fillStyle="rgba(44,0,44,0.44)",m.beginPath(),l[1]=A(l[1],g,.8),x[1]=A(x[1],g,.8),t[1]=A(t[1],g,.8),m.moveTo(...l),m.lineTo(...x),m.lineTo(...t),m.lineTo(...l),m.fill(),o[1]+=11;let a=e=>{for(let l=.1;l<1;l+=.1)e>l&&(e*=1.1);return.15*e};e>.5&&(m.fillStyle="yellow",m.globalAlpha=e>.5?Math.sin(1.5*Y)>Math.random()-.5:(10*a(e+Math.random()))**2,m.beginPath(),m.arc(...o,20*a(e+Math.random()),0,p),m.fill(),m.globalAlpha=1),o[1]-=1,m.fillStyle="orange",m.globalAlpha=e>.5?Math.sin(1.5*Y)>Math.random()-.5:(10*e)**2,m.beginPath(),m.arc(...o,14*a(e+Math.random()),0,p),m.fill(),m.globalAlpha=1,o[1]-=1,m.fillStyle=Q>K?"red":"purple",m.globalAlpha=a(e+Math.random())>.5?Math.sin(1.5*Y)>Math.random()-.5:(10*a(e+Math.random()))**2,m.beginPath(),m.arc(...o,10*a(e+Math.random()),0,p),m.fill(),m.globalAlpha=1},te=125,oe=e=>e.trim().split(/\s+/g),ae=oe("_ c c# d d# e f f# g g# a a# b"),ne=(e,l)=>(e=ae.indexOf(e))&&32.7*(2**(1/12))**(e-1+12*l),ie=(e,l)=>{e.value=l},re=(e,l)=>{let x=I.createOscillator(),t=I.createGain(),o=x.frequency,a=t.gain;return ie(o,0),ie(a,Math.log2(1+.025*e)),x.type=l,x.start(),x.connect(t).connect(I.destination),[o,a]};const _e=async(e,l,x,t,o,a)=>{for(j of e)ie(t,A(l,x,j[0])*a),ie(o,.04*(j[1]||j[0])),await P(10)};function*fe([e,l],t,o,a){for(;;)for(j of oe(a)){let[,a,n,i=1]=j.match(/^(\w#?|_)(\d?)x?(\d+)?$/);if("x"===a)_e([[1],[.75,.7],[.75,.7],[.7],[.57,.6],[.27,.6],[.17,.5],[.1,.4],[.1,.2],[0]],111,255,e,l,o);else if("o"===a)_e([[.4],[.8],[1],[.75,.7],[.7],[.57,.6],[.27,.6],[.17,.5],[.1,.4],[.1,.2],[0]],15,70,e,l,o);else{let l=ne(a,n);ie(e,l*o)}for(j of x(t*i))yield}}te=6e4/330/2;let be="_x24 ",ge=be+"_x8 ",de="o o x o x o x o ",he="o o x o o o x o "+de+de+de,ce="e3x2 _x2 e3x2 d3x2 e3x2 _x2 e3x2 _x2 g3x2 _x2 g3x2 d3x2 g3x2 _x2 g3x2 _x2 ",se="e4x2 _x2 e4x2 _x2 e4 _ g4 _ b4x2 _x2 ",me=e=>(e+" _ ").repeat(7)+e+"x2 ",pe=me("e4"),ye="e3 _ e3 _ g3 _ a3 _ b3 _ b3 _ a3 _ g3x2 ",Te=""+pe+me("d4"),ue=""+pe+me("g4"),Se=""+ye+ye,we=""+ce+se+se+ce+se+"e4x2 _x2 e4x2 _x2 e4 _ d4 _ e4x2 _x2 "+Te+Se+Te+(""+ye+me("e3"))+ue+Se+Te+(ye+"b3 _ a3 _ a3x2 _x2 b3 _ a3 _ d3x2 _x2 "),Me="b3x2 _x2 b3x2 _x2 b3 _ d4 _ e4x2 _x2 ",Pe=""+me("b3")+me("a3")+ge,Ae=""+ge+Me+Me+ge+Me+"b3x2 _x2 b3x2 _x2 b3 _ a3 _ b3x2 _x2 "+Pe+Pe+(""+me("b3")+me("d4")+ge)+Pe,ve="b5x2 _x2 g5x2 _x2 e5x2 _x2 b5x2 _x2 g5x2 _x2 e5x2 _x2 ",Ce="e5 _ g5 _ b5 _ e5 _ g5 _ b5 _ e5 _ g5 _ b5 _ e5 _ g5 _ b5 _ ",Re=Ce+"b5 _ b5 _ b5x4 "+ge,$e=""+(ve+"b5x2 _x2 g5x2 _x2 e5x8 "+be)+(ve+"b5x2 _x2 c6x2 _x2 e5x8 "+be)+Re+(Ce+"b5 _ a5 _ b5x4 "+ge)+(Ce+"d6 _ e6 _ b5x4 "+ge)+Re;k.then((()=>{I=new AudioContext,(async e=>{for(;;){for(let[l,x]of e)P(x).then((()=>l.next()));await P(te)}})([[fe(re(.3,"sawtooth"),1,1,we),34],[fe(re(.3),1,1,we),16],[fe(re(.1,""),1,1,Ae),16],[fe(re(.125,""),1,.5,$e),16],[fe(re(.3),1,1,$e),16],[fe(re(0,"square"),2,1,he),0]])})),k.then((()=>{c.requestFullscreen?.().catch(l)}));</script>